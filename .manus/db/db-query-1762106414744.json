{
  "query": "\n-- Tabela de Roles\nCREATE TABLE IF NOT EXISTS roles (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  empresaId INT NOT NULL,\n  nome VARCHAR(100) NOT NULL,\n  descricao TEXT,\n  cor VARCHAR(20),\n  ativo BOOLEAN DEFAULT TRUE NOT NULL,\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  atualizadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (empresaId) REFERENCES empresas(id) ON DELETE CASCADE\n);\n\n-- Tabela de Colaboradores\nCREATE TABLE IF NOT EXISTS colaboradores (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  empresaId INT NOT NULL,\n  usuarioId INT,\n  email VARCHAR(320) NOT NULL,\n  nome VARCHAR(255) NOT NULL,\n  roleId INT NOT NULL,\n  status ENUM('ativo', 'inativo', 'pendente') DEFAULT 'pendente' NOT NULL,\n  dataConvite TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  dataAceite TIMESTAMP,\n  departamento VARCHAR(100),\n  cargo VARCHAR(100),\n  telefone VARCHAR(50),\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  atualizadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  criadoPor INT,\n  FOREIGN KEY (empresaId) REFERENCES empresas(id) ON DELETE CASCADE,\n  FOREIGN KEY (usuarioId) REFERENCES users(id) ON DELETE SET NULL,\n  FOREIGN KEY (roleId) REFERENCES roles(id) ON DELETE RESTRICT,\n  FOREIGN KEY (criadoPor) REFERENCES users(id) ON DELETE SET NULL\n);\n\n-- Tabela de Permissões\nCREATE TABLE IF NOT EXISTS permissoes (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  roleId INT NOT NULL,\n  modulo VARCHAR(100) NOT NULL,\n  pode_visualizar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_criar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_editar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_deletar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_exportar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_compartilhar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_executar_acoes BOOLEAN DEFAULT FALSE,\n  pode_gerar_relatorios BOOLEAN DEFAULT FALSE,\n  pode_usar_laboratorio BOOLEAN DEFAULT FALSE,\n  pode_gerenciar_usuarios BOOLEAN DEFAULT FALSE,\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  atualizadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (roleId) REFERENCES roles(id) ON DELETE CASCADE\n);\n\n-- Tabela de Audit Logs\nCREATE TABLE IF NOT EXISTS audit_logs (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  empresaId INT NOT NULL,\n  usuarioId INT,\n  acao VARCHAR(100) NOT NULL,\n  modulo VARCHAR(100) NOT NULL,\n  recursoId INT,\n  recursoTipo VARCHAR(100),\n  descricao TEXT,\n  mudancasAntes JSON,\n  mudancasDepois JSON,\n  enderecoIP VARCHAR(45),\n  userAgent TEXT,\n  resultado ENUM('sucesso', 'erro', 'acesso_negado') DEFAULT 'sucesso' NOT NULL,\n  mensagemErro TEXT,\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (empresaId) REFERENCES empresas(id) ON DELETE CASCADE,\n  FOREIGN KEY (usuarioId) REFERENCES users(id) ON DELETE SET NULL\n);\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2J8CDKTx9VdfXU7.8ffe2f5d6b06 --database KzLjingKdmafj6rcuPmgia --execute \n-- Tabela de Roles\nCREATE TABLE IF NOT EXISTS roles (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  empresaId INT NOT NULL,\n  nome VARCHAR(100) NOT NULL,\n  descricao TEXT,\n  cor VARCHAR(20),\n  ativo BOOLEAN DEFAULT TRUE NOT NULL,\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  atualizadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (empresaId) REFERENCES empresas(id) ON DELETE CASCADE\n);\n\n-- Tabela de Colaboradores\nCREATE TABLE IF NOT EXISTS colaboradores (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  empresaId INT NOT NULL,\n  usuarioId INT,\n  email VARCHAR(320) NOT NULL,\n  nome VARCHAR(255) NOT NULL,\n  roleId INT NOT NULL,\n  status ENUM('ativo', 'inativo', 'pendente') DEFAULT 'pendente' NOT NULL,\n  dataConvite TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  dataAceite TIMESTAMP,\n  departamento VARCHAR(100),\n  cargo VARCHAR(100),\n  telefone VARCHAR(50),\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  atualizadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  criadoPor INT,\n  FOREIGN KEY (empresaId) REFERENCES empresas(id) ON DELETE CASCADE,\n  FOREIGN KEY (usuarioId) REFERENCES users(id) ON DELETE SET NULL,\n  FOREIGN KEY (roleId) REFERENCES roles(id) ON DELETE RESTRICT,\n  FOREIGN KEY (criadoPor) REFERENCES users(id) ON DELETE SET NULL\n);\n\n-- Tabela de Permissões\nCREATE TABLE IF NOT EXISTS permissoes (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  roleId INT NOT NULL,\n  modulo VARCHAR(100) NOT NULL,\n  pode_visualizar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_criar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_editar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_deletar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_exportar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_compartilhar BOOLEAN DEFAULT FALSE NOT NULL,\n  pode_executar_acoes BOOLEAN DEFAULT FALSE,\n  pode_gerar_relatorios BOOLEAN DEFAULT FALSE,\n  pode_usar_laboratorio BOOLEAN DEFAULT FALSE,\n  pode_gerenciar_usuarios BOOLEAN DEFAULT FALSE,\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  atualizadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (roleId) REFERENCES roles(id) ON DELETE CASCADE\n);\n\n-- Tabela de Audit Logs\nCREATE TABLE IF NOT EXISTS audit_logs (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  empresaId INT NOT NULL,\n  usuarioId INT,\n  acao VARCHAR(100) NOT NULL,\n  modulo VARCHAR(100) NOT NULL,\n  recursoId INT,\n  recursoTipo VARCHAR(100),\n  descricao TEXT,\n  mudancasAntes JSON,\n  mudancasDepois JSON,\n  enderecoIP VARCHAR(45),\n  userAgent TEXT,\n  resultado ENUM('sucesso', 'erro', 'acesso_negado') DEFAULT 'sucesso' NOT NULL,\n  mensagemErro TEXT,\n  criadoEm TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n  FOREIGN KEY (empresaId) REFERENCES empresas(id) ON DELETE CASCADE,\n  FOREIGN KEY (usuarioId) REFERENCES users(id) ON DELETE SET NULL\n);\n",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 883
}